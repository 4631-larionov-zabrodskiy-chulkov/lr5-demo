# Основные понятия.

Регрессио́нный анализ — статистический метод исследования влияния одной или нескольких независимых переменных X1, X2, ... , Xn на зависимую переменную Y. Независимые переменные иначе называют регрессорами или предикторами, а зависимые переменные — критериальными.

Уравнение регрессии — это математическая формула, применяемая к независимым переменным, чтобы лучше спрогнозировать зависимую переменную, которую необходимо смоделировать. 

Уравнение регрессии может выглядеть следующим образом:
Y =0 +1X1 +2X2 + ... + nXn + , где 

Зависимая переменная (Y) — это переменная, описывающая процесс, который мы пытаемся предсказать или понять. 

Независимые переменные (X) это переменные, используемые для моделирования или прогнозирования значений зависимых переменных. В уравнении регрессии они располагаются справа от знака равенства и часто называются объяснительными переменными. Зависимая переменная - это функция независимых переменных. 

Коэффициенты регрессии (β) — это коэффициенты, которые рассчитываются в результате выполнения регрессионного анализа. Вычисляются величины для каждой независимой переменной, которые представляют силу и тип взаимосвязи независимой переменной по отношению к зависимой. 

# Метод наименьших квадратов для расчета коэффициентов регрессии.

Для оценки параметров уравнения множественной регрессии применяют метод наименьших квадратов (МНК). Для линейных уравнений и нелинейных уравнений, приводимых к линейным, строится следующая система нормальных уравнений, решение которой позволяет получить оценки параметров регрессии:

![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_4.gif)
![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_5.gif)
![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_6.gif)

Для ее решения может быть применен метод определителей:

![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_7.gif), ![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_8.gif), ![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_9.gif)

где  Da, Db1,…, Dbp – частные определители, которые получаются заменой соответствующего столбца матрицы определителя системы данными левой части системы;

![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_10.gif) - определитель системы.


# Критерий Фишера. Адекватность уравнения регрессии.

Значимость уравнения множественной регрессии в целом, так же как и в парной регрессии, оценивается с помощью F-критерия Фишера. Данный критерий очень важен в регрессионном анализе и по существу является частным случаем проверки ограничений. В данном случае нулевая гипотеза — об одновременном равенстве нулю всех коэффициентов при факторах регрессионной модели (то есть всего ограничений k-1). В данном случае короткая модель — это просто константа в качестве фактора, то есть коэффициент детерминации короткой модели равен нулю. Статистика теста равна:

![alt text](https://wikimedia.org/api/rest_v1/media/math/render/svg/8305967e1dc48a283ff5b866ea379be37f747916), ![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_8.gif), ![alt_text](https://students-library.com/files/5/126/mnozhestvennaja-regressija-i-korreljacija_9.gif)

## Пример:

Пусть оценивается линейная регрессия доли расходов на питание в общей сумме расходов на константу, логарифм совокупных расходов, количество взрослых членов семьи и количество детей до 11 лет. То есть всего в модели 4 оцениваемых параметра (k=4). Пусть по результатам оценки регрессии получен коэффициент детерминации ![alt text](https://wikimedia.org/api/rest_v1/media/math/render/svg/ad9960cd1be8d25072c4aa6e628a7ce66467dd39)  По вышеприведенной формуле рассчитаем значение F-статистики в случае, если регрессия оценена по данным 34 наблюдений и по данным 64 наблюдений:![alt text](https://wikimedia.org/api/rest_v1/media/math/render/svg/d3209f2a2882d9de5f18fd905f3ecef96e1b5c2f) 

![alt text](https://wikimedia.org/api/rest_v1/media/math/render/svg/450b736e0dde3b51d330db1b6825fccdf4a3f4c1)

Критическое значение статистики при 1 % уровне значимости в первом случае равно ![alt text](https://wikimedia.org/api/rest_v1/media/math/render/svg/3e806d8c52f96f6a5ddb4d629135eb58f738792d)  а во втором случае ![alt text](https://wikimedia.org/api/rest_v1/media/math/render/svg/f59588943799176e7c7400b9ad3844aff0ead97b) В обоих случаях регрессия признается значимой при заданном уровне значимости. В первом случае P-значение равно 0,1 %, а во втором — 0,00005 %. Таким образом, во втором случае уверенность в значимости регрессии существенно выше (существенно меньше вероятность ошибки в случае признания модели значимой).

# Критерий Стьюдента

Проверка статистической значимости параметров регрессионного уравнения (коэффициентов регрессии) выполняется по t-критерию Стьюдента, который рассчитывается по формуле:

![alt text](https://www.chem-astu.ru/science/reference/formula_t.gif)

где P - значение параметра;
      Sp - стандартное отклонение параметра.

Рассчитанное значение критерия Стьюдента сравнивают с его табличным значением при выбранной доверительной вероятности (как правило, 0.95) и числе степеней свободы N-k-1, где N-число точек, k-число переменных в регрессионном уравнении (например, для линейной модели Y=A*X+B подставляем k=1).

Если вычисленное значение tp выше, чем табличное, то коэффициент регрессии является значимым с данной доверительной вероятностью. В противном случае есть основания для исключения соответствующей переменной из регрессионной модели.

Величины параметров и их стандартные отклонения обычно рассчитываются в алгоритмах, реализующих метод наименьших квадратов.

## Пример:

Для изучения эффективности нового препарата железа были выбраны две группы пациентов с анемией. В первой группе пациенты в течение двух недель получали новый препарат, а во второй группе - получали плацебо. После этого было проведено измерение уровня гемоглобина в периферической крови. В первой группе средний уровень гемоглобина составил 115,4±1,2 г/л, а во второй - 103,7±2,3 г/л (данные представлены в формате M±m), сравниваемые совокупности имеют нормальное распределение. При этом численность первой группы составила 34, а второй - 40 пациентов. Необходимо сделать вывод о статистической значимости полученных различий и эффективности нового препарата железа.
Для оценки значимости различий используем t-критерий Стьюдента, рассчитываемый как разность средних значений, поделенная на сумму квадратов ошибок:

![alt_text](http://medstatistic.ru/theory/example_student.png)

После выполнения расчетов, значение t-критерия оказалось равным 4,51. Находим число степеней свободы как (34 + 40) - 2 = 72. Сравниваем полученное значение t-критерия Стьюдента 4,51 с критическим при р=0,05 значением, указанным в таблице: 1,993. Так как рассчитанное значение критерия больше критического, делаем вывод о том, что наблюдаемые различия статистически значимы (уровень значимости р<0,05).

# Различия Matlab и Octave

Octave в основном построен с учетом совместимости с MATLAB. Он имеет много общих черт с MATLAB:
- Матрицы как фундаментальный тип данных.
- Встроенная поддержка комплексных чисел.
- Мощные встроенные математические функции и обширные библиотеки функций.
- Расширяемость в виде пользовательских функций.

Однако синтаксический анализатор Octave допускает некоторый (часто очень полезный) синтаксис, которого нет в MATLAB, поэтому программы, написанные для Octave, могут не работать в MATLAB. Например, Octave поддерживает использование одинарных и двойных кавычек, тогда как более старые версии MATLAB поддерживали только одинарные кавычки, что означало ошибки синтаксического анализа, возникающие при попытке использовать двойные кавычки (например, в скрипте Octave при запуске на MATLAB). Более поздние версии MATLAB вводили двойные кавычки, но с функциональностью, отличной от одинарных кавычек (хотя и с некоторым перекрытием в функциональности).   
[Некоторые различияя Matlab и Octave](https://en.wikibooks.org/wiki/MATLAB_Programming/Differences_between_Octave_and_MATLAB)   
[Пакет statistics Octave и функция, которые в нём реализованы](https://wiki.octave.org/Statistics_package)   
